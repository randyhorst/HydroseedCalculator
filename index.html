<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hydroseeding Calculator</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            -webkit-tap-highlight-color: transparent;
        }
        /* Custom styles for better number input controls */
        input[type=number]::-webkit-inner-spin-button,
        input[type=number]::-webkit-outer-spin-button {
            -webkit-appearance: none;
            margin: 0;
        }
        input[type=number] {
            -moz-appearance: textfield;
        }
        /* Style for date input in dark mode */
        input[type=date] {
            color-scheme: dark;
        }
        .output-field {
            background-color: #374151; /* gray-700 */
            border: 1px solid #4b5563; /* gray-600 */
            color: #f3f4f6; /* gray-100 */
            padding: 0.5rem 0.75rem;
            border-radius: 0.5rem;
            font-weight: 600;
            text-align: center;
        }
         .input-field {
            background-color: #1f2937; /* gray-800 */
            border: 1px solid #4b5563; /* gray-600 */
        }
        
        /* Custom gradient for the title */
        .gradient-text {
            background-image: linear-gradient(to right, #84cc16, #22c55e); /* lime-500 to emerald-500 */
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            color: transparent; /* Fallback for browsers that don't support text-fill-color */
        }
        
        /* Stop webkit from adding its own arrow */
        summary::-webkit-details-marker {
            display: none;
        }


        /* --- 
        NEW: ADVANCED PRINT STYLES (Invoice Format - Tighter)
        --- */
        @media print {
            @page {
                size: letter;
                margin: 0.5in; /* Tighter page margins */
            }
            body {
                background-color: #ffffff;
                color: #000000;
                font-family: Arial, sans-serif;
                font-size: 9pt; /* Tighter base font */
            }
            
            /* Hide the entire app container */
            #app-container {
                display: none !important;
            }
            
            /* Show the hidden invoice */
            #print-invoice {
                display: block !important;
            }
            
            /* Invoice Styles */
            #print-invoice h1 {
                font-size: 18pt; /* Tighter */
                font-weight: bold;
                text-align: center;
                margin-bottom: 0.2in; /* Tighter */
            }
            #print-invoice h2 {
                font-size: 12pt; /* Tighter */
                font-weight: bold;
                border-bottom: 1px solid #000; /* Tighter */
                padding-bottom: 2px; /* Tighter */
                margin-top: 0.2in; /* Tighter */
                margin-bottom: 0.1in; /* Tighter */
            }
            #print-invoice-header {
                font-size: 10pt; /* Tighter */
                margin-bottom: 0.2in; /* Tighter */
            }
            
            /* Table Styles */
            #print-invoice table {
                width: 100%;
                border-collapse: collapse;
                margin-top: 0.05in; /* Tighter */
            }
            #print-invoice th, #print-invoice td {
                border: 1px solid #999;
                padding: 4px 6px; /* Tighter */
                text-align: left;
                font-size: 9pt; /* Tighter */
            }
            #print-invoice th {
                background-color: #f0f0f0;
                font-weight: bold;
            }
            #print-invoice td.text-right, #print-invoice th.text-right {
                text-align: right;
            }
            
            /* Notes Section */
            #print-notes-content {
                white-space: pre-wrap; /* Respect newlines in notes */
                font-size: 9pt; /* Tighter */
                border: 1px solid #eee;
                padding: 4px 6px; /* Tighter */
                background: #fdfdfd;
                min-height: 40px; /* Tighter */
            }
            
            /* Other Calcs Section */
            #print-other-calcs {
                display: grid;
                grid-template-columns: 1fr 1fr;
                gap: 0.5in; /* Tighter */
                font-size: 9pt; /* Tighter */
            }
        }
    </style>
</head>
<body class="bg-gray-900 text-gray-200 antialiased pt-8 pb-24">

    <!-- THIS IS THE APP CONTAINER, HIDDEN ON PRINT -->
    <div id="app-container" class="max-w-2xl mx-auto px-4">
        <!-- Header -->
        <header class="text-center mb-6 no-print">
            <h1 class="text-4xl font-extrabold gradient-text tracking-tight drop-shadow-lg">Hydroseeding Calculator</h1>
        </header>

        <main class="space-y-4"> 
            <!-- 1. Project Specs -->
            <div id="card-specs" class="bg-gray-800 p-5 rounded-xl shadow-lg print-card">
                <h2 class="text-xl font-semibold mb-4 text-emerald-400">1. Project Specs</h2>
                
                <!-- Customer and Date -->
                <div class="grid grid-cols-1 sm:grid-cols-2 gap-x-4 gap-y-2 mb-2 no-print">
                    <div class="grid grid-cols-3 items-center gap-3">
                         <label for="customerName" class="col-span-1 font-medium text-gray-300 text-sm">Customer</label> 
                         <input type="text" id="customerName" placeholder="Enter name" class="col-span-2 w-full p-2 rounded-lg bg-gray-700 border border-gray-600 text-white text-sm font-semibold focus:outline-none focus:ring-2 focus:ring-emerald-500 transition">
                    </div>
                    <div class="grid grid-cols-3 items-center gap-3">
                         <label for="projectDate" class="col-span-1 font-medium text-gray-300 text-sm">Date</label> 
                         <input type="date" id="projectDate" class="col-span-2 w-full p-2 rounded-lg bg-gray-700 border border-gray-600 text-white text-sm font-semibold focus:outline-none focus:ring-2 focus:ring-emerald-500 transition">
                    </div>
                </div>

                <!-- Area Input - Reverted size -->
                <div class="grid grid-cols-3 items-center gap-3 mb-4"> 
                    <label for="area" class="col-span-1 font-medium text-gray-300">Total Area (ha)</label> 
                    <input type="number" id="area" value="0" placeholder="0" class="col-span-2 w-full p-2 rounded-lg bg-gray-700 border border-gray-600 text-white text-base font-semibold focus:outline-none focus:ring-2 focus:ring-emerald-500 transition">
                </div>

                <!-- Application Rates -->
                <h3 class="text-lg font-semibold mb-3 text-gray-200">Application Rates</h3>
                <div class="space-y-4">
                    <div class="grid grid-cols-5 items-center gap-3">
                        <label for="mulchRate" class="col-span-2 font-medium">Mulch</label>
                        <input type="number" id="mulchRate" value="0" placeholder="0" class="col-span-2 p-2 rounded-md bg-gray-700 border border-gray-600 text-white text-center focus:outline-none focus:ring-1 focus:ring-emerald-500">
                        <span class="text-gray-400">kg/ha</span>
                    </div>
                    <div class="grid grid-cols-5 items-center gap-3">
                        <label for="seedRate" class="col-span-2 font-medium">Seed</label>
                        <input type="number" id="seedRate" value="0" placeholder="0" class="col-span-2 p-2 rounded-md bg-gray-700 border border-gray-600 text-white text-center focus:outline-none focus:ring-1 focus:ring-emerald-500">
                        <span class="text-gray-400">kg/ha</span>
                    </div>
                    <div class="grid grid-cols-5 items-center gap-3">
                        <label for="fertilizerRate" class="col-span-2 font-medium">Fertilizer</label>
                        <input type="number" id="fertilizerRate" value="0" placeholder="0" class="col-span-2 p-2 rounded-md bg-gray-700 border border-gray-600 text-white text-center focus:outline-none focus:ring-1 focus:ring-emerald-500">
                        <span class="text-gray-400">kg/ha</span>
                    </div>
                </div>

                <!-- Collapsible Material Bag Weights -->
                <details class="group pt-4 mt-4 border-t border-gray-700">
                    <summary class="flex justify-between items-center cursor-pointer text-emerald-400 hover:text-emerald-300 font-medium list-none">
                        <span>Material Bag Weight Settings</span>
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 transition-transform duration-200 group-open:rotate-180 no-print" viewBox="0 0 20 20" fill="currentColor">
                            <path fill-rule="evenodd" d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z" clip-rule="evenodd" />
                        </svg>
                    </summary>
                    <div class="space-y-4 mt-4 pt-4 border-t border-gray-600">
                         <div class="grid grid-cols-5 items-center gap-3">
                            <label for="seedBagWeight" class="col-span-2 font-medium">Seed Bag</label>
                            <input type="number" id="seedBagWeight" value="25" class="col-span-2 p-2 rounded-md bg-gray-700 border border-gray-600 text-white text-center focus:outline-none focus:ring-1 focus:ring-emerald-500">
                            <span class="text-gray-400">kg</span>
                        </div>
                        <div class="grid grid-cols-5 items-center gap-3">
                            <label for="fertilizerBagWeight" class="col-span-2 font-medium">Fertilizer Bag</label>
                            <input type="number" id="fertilizerBagWeight" value="25" class="col-span-2 p-2 rounded-md bg-gray-700 border border-gray-600 text-white text-center focus:outline-none focus:ring-1 focus:ring-emerald-500">
                            <span class="text-gray-400">kg</span>
                        </div>
                    </div>
                </details>
                
                <!-- Optional Inputs -->
                <details class="group pt-4 mt-4 border-t border-gray-700">
                    <summary class="flex justify-between items-center cursor-pointer text-emerald-400 hover:text-emerald-300 font-medium list-none">
                        <span>Show Optional Products</span>
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 transition-transform duration-200 group-open:rotate-180 no-print" viewBox="0 0 20 20" fill="currentColor">
                            <path fill-rule="evenodd" d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z" clip-rule="evenodd" />
                        </svg>
                    </summary>
                    <div class="space-y-4 mt-4 pt-4 border-t border-gray-600">
                        
                        <!-- Group AquaGel inputs -->
                        <div class="bg-gray-900/50 p-3 rounded-lg">
                            <div class="grid grid-cols-5 items-center gap-3">
                                <label for="aquaGelRate" class="col-span-2 font-medium">AquaGel Rate</label>
                                <input type="number" id="aquaGelRate" value="0" class="col-span-2 p-2 rounded-md bg-gray-700 border border-gray-600 text-white text-center focus:outline-none focus:ring-1 focus:ring-emerald-500">
                                <span class="text-gray-400">kg/ha</span>
                            </div>
                            <div class="grid grid-cols-5 items-center gap-3 mt-3">
                                <label for="aquaGelBagWeight" class="col-span-2 font-medium">AquaGel Bag</label>
                                <input type="number" id="aquaGelBagWeight" value="25" class="col-span-2 p-2 rounded-md bg-gray-700 border border-gray-600 text-white text-center focus:outline-none focus:ring-1 focus:ring-emerald-500">
                                <span class="text-gray-400">kg</span>
                            </div>
                        </div>

                        <!-- Other optional products -->
                        <div class="grid grid-cols-5 items-center gap-3 mt-3">
                            <label for="jumpStartRate" class="col-span-2 font-medium">Jump Start</label>
                            <input type="number" id="jumpStartRate" value="0" class="col-span-2 p-2 rounded-md bg-gray-700 border border-gray-600 text-white text-center focus:outline-none focus:ring-1 focus:ring-emerald-500">
                            <span class="text-gray-400">kg/ha</span>
                        </div>
                        <div class="grid grid-cols-5 items-center gap-3">
                            <label for="bsmRate" class="col-span-2 font-medium">BSM</label>
                            <input type="number" id="bsmRate" value="0" class="col-span-2 p-2 rounded-md bg-gray-700 border border-gray-600 text-white text-center focus:outline-none focus:ring-1 focus:ring-emerald-500">
                            <span class="text-gray-400">m2</span>
                        </div>
                    </div>
                </details>
                
                <!-- Project Notes -->
                <details class="group pt-4 mt-4 border-t border-gray-700">
                    <summary class="flex justify-between items-center cursor-pointer text-emerald-400 hover:text-emerald-300 font-medium list-none">
                        <span class="flex items-center">
                            Project Notes
                            <span id="notesIndicator" class="text-emerald-400 ml-2 hidden font-bold text-lg">*</span>
                        </span>
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 transition-transform duration-200 group-open:rotate-180 no-print" viewBox="0 0 20 20" fill="currentColor">
                            <path fill-rule="evenodd" d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z" clip-rule="evenodd" />
                        </svg>
                    </summary>
                    <div class="mt-4 pt-4 border-t border-gray-600 print-notes">
                        <textarea id="projectNotes" rows="4" class="w-full p-2 rounded-md bg-gray-700 border border-gray-600 text-white focus:outline-none focus:ring-1 focus:ring-emerald-500" placeholder="Add any job-site notes, contact info, or instructions here..."></textarea>
                    </div>
                </details>
            </div>
            
            <!-- 2. Truck Load Mix (SWAPPED) -->
            <div id="card-loadmix" class="bg-gray-800 p-5 rounded-xl shadow-lg print-card">
                <h2 class="text-xl font-semibold mb-4 text-emerald-400">2. Truck Load Mix</h2>
                
                <div class="grid grid-cols-3 items-center gap-3 mb-4">
                    <label for="balesPerLoad" class="col-span-1 font-medium text-gray-300">Bales / Load</label>
                    <div class="col-span-2 flex items-center space-x-3">
                        <input type="range" id="balesPerLoadSlider" min="1" max="50" value="30" class="w-full h-2 bg-gray-700 rounded-lg appearance-none cursor-pointer no-print">
                        <input type="number" id="balesPerLoad" value="30" class="w-20 p-2 text-center rounded-md bg-gray-700 border border-gray-600 text-white focus:outline-none focus:ring-1 focus:ring-emerald-500"> 
                    </div>
                </div>

                <div class="grid grid-cols-2 gap-4 mt-4"> 
                    <div class="text-center">
                        <div class="text-sm text-gray-400">Total Loads</div>
                        <div id="totalLoads" class="text-xl font-bold text-white">0</div> 
                    </div>
                     <div class="text-center">
                        <div class="text-sm text-gray-400">Area per Load</div>
                        <div id="areaPerLoad" class="text-xl font-bold text-white">0 m²</div> 
                    </div>
                </div>

                <h3 class="text-lg font-semibold mt-6 mb-3 text-gray-200">Product Mix per Load</h3>
                <div class="space-y-2">
                    <div class="flex justify-between items-center bg-gray-700/50 p-3 rounded-lg">
                        <span class="font-medium">Seed</span>
                        <span id="seedPerLoad" class="font-bold text-emerald-400">0 kg</span>
                    </div>
                    <div class="flex justify-between items-center bg-gray-700/50 p-3 rounded-lg">
                        <span class="font-medium">Fertilizer</span>
                        <span id="fertilizerPerLoad" class="font-bold text-emerald-400">0 kg</span>
                    </div>
                    <div class="flex justify-between items-center bg-gray-700/50 p-3 rounded-lg">
                        <span class="font-medium">AquaGel</span>
                        <span id="aquaGelPerLoad" class="font-bold text-emerald-400">0 kg</span>
                    </div>
                </div>
            </div>
            
            <!-- 3. Calculated Totals (SWAPPED) -->
            <div id="card-totals" class="bg-gray-800 p-5 rounded-xl shadow-lg print-card">
                 <h2 class="text-xl font-semibold mb-4 text-emerald-400">3. Calculated Totals</h2>
                 <div class="grid grid-cols-3 gap-x-4 gap-y-2 text-center text-sm font-medium text-gray-400 mb-3">
                     <span>Product</span>
                     <span>Total Needed</span>
                     <span>Bales/Bags</span>
                 </div>
                 <div class="space-y-3">
                     <div class="grid grid-cols-3 gap-4 items-center">
                         <span class="font-semibold text-gray-200">Mulch</span>
                         <div id="mulchNeeded" class="output-field">0 kg</div>
                         <div id="mulchBales" class="output-field">0</div>
                     </div>
                     <div class="grid grid-cols-3 gap-4 items-center">
                         <span class="font-semibold text-gray-200">Seed</span>
                         <div id="seedNeeded" class="output-field">0 kg</div>
                         <div id="seedBags" class="output-field">0</div>
                     </div>
                     <div class="grid grid-cols-3 gap-4 items-center">
                         <span class="font-semibold text-gray-200">Fertilizer</span>
                         <div id="fertilizerNeeded" class="output-field">0 kg</div>
                         <div id="fertilizerBags" class="output-field">0</div>
                     </div>
                      <div class="grid grid-cols-3 gap-4 items-center">
                         <span class="font-semibold text-gray-200">AquaGel</span>
                         <div id="aquaGelNeeded" class="output-field">0 kg</div>
                         <div id="aquaGelBags" class="output-field">0</div>
                     </div>
                 </div>
            </div>

            <!-- 4. Other Calculations -->
            <div id="card-other" class="bg-gray-800 p-5 rounded-xl shadow-lg print-card">
                 <h2 class="text-xl font-semibold mb-4 text-emerald-400">4. Other Calculations</h2>
                 <div class="grid grid-cols-2 gap-4 text-center">
                    <div>
                        <div class="text-sm text-gray-400">Mulch Stacks</div>
                        <div id="mulchStacks" class="text-2xl font-bold text-white mt-1">0</div>
                         <p class="text-xs text-gray-500 mt-1">(40 bales/stack)</p>
                    </div>
                    <div>
                        <div class="text-sm text-gray-400">Area in Acres</div>
                        <div id="areaAcres" class="text-2xl font-bold text-white mt-1">0</div>
                        <p class="text-xs text-gray-500 mt-1">(~2.47 ac/ha)</p>
                    </div>
                 </div>
            </div>
            
             <!-- Reference Table (no-print hides it) -->
             <div class="bg-gray-800 p-5 rounded-xl shadow-lg no-print">
                 <h2 class="text-xl font-semibold mb-4 text-emerald-400">Reference</h2>
                 <div class="text-center">
                     <p class="font-medium mb-2 text-gray-300">Hydroseeder Bale Capacity</p>
                     <div class="inline-flex bg-gray-700/50 rounded-lg p-1 text-sm">
                         <div class="px-4 py-2">
                            <span class="font-bold text-white">400:</span>
                            <span class="text-gray-300"> 34-35 bales</span>
                        </div>
                         <div class="border-l border-gray-600 px-4 py-2">
                            <span class="font-bold text-white">300:</span>
                            <span class="text-gray-300"> 28-29 bales</span>
                        </div>
                     </div>
                 </div>
            </div>

            <!-- Print Button (MOVED TO BOTTOM) -->
            <div class="mt-8 flex justify-center gap-4 no-print"> 
                <!-- NEW: Reset Button -->
                <button id="resetButton" class="inline-flex items-center justify-center px-6 py-3 bg-gray-600 hover:bg-gray-500 text-white font-semibold rounded-lg shadow-md transition-colors focus:outline-none focus:ring-2 focus:ring-gray-400 focus:ring-offset-2 focus:ring-offset-gray-900">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                      <path stroke-linecap="round" stroke-linejoin="round" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m-15.357-2a8.001 8.001 0 0015.357 2m0 0H15" />
                    </svg>
                    Reset Form
                </button>
                
                <!-- Print button color changed -->
                <button id="print-button" onclick="window.print()" class="inline-flex items-center justify-center px-6 py-3 bg-emerald-600 hover:bg-emerald-500 text-white font-semibold rounded-lg shadow-md transition-colors focus:outline-none focus:ring-2 focus:ring-emerald-400 focus:ring-offset-2 focus:ring-offset-gray-900">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" viewBox="0 0 20 20" fill="currentColor">
                        <path fill-rule="evenodd" d="M5 4v3H4a2 2 0 00-2 2v6a2 2 0 002 2h12a2 2 0 002-2V9a2 2 0 00-2-2h-1V4a2 2 0 00-2-2H7a2 2 0 00-2 2zm8 0H7v3h6V4zm0 8H7v4h6v-4z" clip-rule="evenodd" />
                    </svg>
                    Print / Save as PDF
                </button>
            </div>

        </main>
    </div>
    
    <!-- 
    NEW: HIDDEN INVOICE FOR PRINTING 
    This is hidden on screen and shown only for print.
    -->
    <div id="print-invoice" class="hidden">
        <h1>Hydroseeding Calculator</h1>
        
        <div id="print-invoice-header">
            <div class="grid grid-cols-2 gap-4">
                <div><strong>Customer:</strong> <span id="print-customer"></span></div>
                <div><strong>Date:</strong> <span id="print-date"></span></div>
            </div>
            <div><strong>Total Area:</strong> <span id="print-area"></span> ha</div>
        </div>
        
        <!-- Totals -->
        <section>
            <h2>Material Totals</h2>
            <table>
                <thead>
                    <tr>
                        <th>Product</th>
                        <th class="text-right">Rate (kg/ha)</th>
                        <th class="text-right">Total Bales/Bags</th>
                        <th class="text-right">Total Needed (kg)</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><strong>Mulch</strong></td>
                        <td id="print-mulch-rate" class="text-right"></td>
                        <td id="print-mulch-bales" class="text-right"></td>
                        <td id="print-mulch-needed" class="text-right"></td>
                    </tr>
                    <tr>
                        <td><strong>Seed</strong></td>
                        <td id="print-seed-rate" class="text-right"></td>
                        <td id="print-seed-bags" class="text-right"></td>
                        <td id="print-seed-needed" class="text-right"></td>
                    </tr>
                    <tr>
                        <td><strong>Fertilizer</strong></td>
                        <td id="print-fert-rate" class="text-right"></td>
                        <td id="print-fert-bags" class="text-right"></td>
                        <td id="print-fert-needed" class="text-right"></td>
                    </tr>
                    <tr>
                        <td><strong>AquaGel</strong></td>
                        <td id="print-aqua-rate" class="text-right"></td>
                        <td id="print-aqua-bags" class="text-right"></td>
                        <td id="print-aqua-needed" class="text-right"></td>
                    </tr>
                </tbody>
            </table>
        </section>

        <!-- Load Mix -->
        <section>
            <h2>Truck Load Mix</h2>
            <div id="print-load-summary" class="grid grid-cols-3 gap-4">
                <div><strong>Bales per Load:</strong> <span id="print-bales-load"></span></div>
                <div><strong>Total Loads:</strong> <span id="print-total-loads"></span></div>
                <div><strong>Area per Load:</strong> <span id="print-area-load"></span></div>
            </div>
            <table>
                <thead>
                    <tr>
                        <th>Product</th>
                        <th class="text-right">Amount per Load</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><strong>Seed</strong></td>
                        <td id="print-seed-load" class="text-right"></td>
                    </tr>
                    <tr>
                        <td><strong>Fertilizer</strong></td>
                        <td id="print-fert-load" class="text-right"></td>
                    </tr>
                    <tr>
                        <td><strong>AquaGel</strong></td>
                        <td id="print-aqua-load" class="text-right"></td>
                    </tr>
                </tbody>
            </table>
        </section>
        
        <!-- Other Calcs -->
        <section>
            <h2>Other Calculations</h2>
            <div id="print-other-calcs">
                <div><strong>Mulch Stacks:</strong> <span id="print-mulch-stacks"></span></div>
                <div><strong>Area in Acres:</strong> <span id="print-area-acres"></span></div>
            </div>
        </section>

        <!-- Notes -->
        <section>
            <h2>Project Notes</h2>
            <p id="print-notes-content"></p>
        </section>
    </div>

    <!-- Firebase SDKs REMOVED -->
    
    <script>
        // --- GLOBAL CONFIG & STATE ---
        let inputs = {};
        let outputs = {};
        // Add all print elements to controls
        const controls = {
            resetButton: document.getElementById('resetButton'),
            notesIndicator: document.getElementById('notesIndicator'),
            
            // Print-only fields
            printCustomer: document.getElementById('print-customer'),
            printDate: document.getElementById('print-date'),
            printArea: document.getElementById('print-area'),
            
            printMulchRate: document.getElementById('print-mulch-rate'),
            printMulchNeeded: document.getElementById('print-mulch-needed'),
            printMulchBales: document.getElementById('print-mulch-bales'),
            
            printSeedRate: document.getElementById('print-seed-rate'),
            printSeedNeeded: document.getElementById('print-seed-needed'),
            printSeedBags: document.getElementById('print-seed-bags'),
            
            printFertRate: document.getElementById('print-fert-rate'),
            printFertNeeded: document.getElementById('print-fert-needed'),
            printFertBags: document.getElementById('print-fert-bags'),
            
            printAquaRate: document.getElementById('print-aqua-rate'),
            printAquaNeeded: document.getElementById('print-aqua-needed'),
            printAquaBags: document.getElementById('print-aqua-bags'),
            
            printBalesLoad: document.getElementById('print-bales-load'),
            printTotalLoads: document.getElementById('print-total-loads'),
            printAreaLoad: document.getElementById('print-area-load'),
            
            printSeedLoad: document.getElementById('print-seed-load'),
            printFertLoad: document.getElementById('print-fert-load'),
            printAquaLoad: document.getElementById('print-aqua-load'),
            
            printMulchStacks: document.getElementById('print-mulch-stacks'),
            printAreaAcres: document.getElementById('print-area-acres'),
            printNotesContent: document.getElementById('print-notes-content')
        };
        
        // Constants
        const CONSTANTS = {
            KG_PER_MULCH_BALE: 22.7,
            BALES_PER_MULCH_STACK: 40,
            HA_TO_ACRES: 2.47105,
            HA_TO_M2: 10000,
        };

        // --- CALCULATION LOGIC ---
        function calculate() {
            // --- 1. Read Inputs ---
            const area = parseFloat(inputs.area.value) || 0;
            const mulchRate = parseFloat(inputs.mulchRate.value) || 0;
            const seedRate = parseFloat(inputs.seedRate.value) || 0;
            const fertilizerRate = parseFloat(inputs.fertilizerRate.value) || 0;
            const aquaGelRate = parseFloat(inputs.aquaGelRate.value) || 0;
            const balesPerLoad = parseInt(inputs.balesPerLoad.value) || 0;
            const seedBagWeight = parseFloat(inputs.seedBagWeight.value) || 1;
            const fertilizerBagWeight = parseFloat(inputs.fertilizerBagWeight.value) || 1;
            const aquaGelBagWeight = parseFloat(inputs.aquaGelBagWeight.value) || 1;
            
            // --- 2. Perform Calculations ---
            const totalKg = {
                mulch: area * mulchRate,
                seed: area * seedRate,
                fertilizer: area * fertilizerRate,
                aquaGel: area * aquaGelRate,
            };
            const totalBalesBags = {
                mulch: totalKg.mulch / CONSTANTS.KG_PER_MULCH_BALE,
                seed: totalKg.seed / seedBagWeight,
                fertilizer: totalKg.fertilizer / fertilizerBagWeight,
                aquaGel: totalKg.aquaGel / aquaGelBagWeight,
            };
            const totalLoads = balesPerLoad > 0 ? totalBalesBags.mulch / balesPerLoad : 0;
            const areaM2 = area * CONSTANTS.HA_TO_M2;
            const areaPerLoad = totalLoads > 0 ? areaM2 / totalLoads : 0;
            const perLoad = {
                seed: totalLoads > 0 ? totalKg.seed / totalLoads : 0,
                fertilizer: totalLoads > 0 ? totalKg.fertilizer / totalLoads : 0,
                aquaGel: totalLoads > 0 ? totalKg.aquaGel / totalLoads : 0,
            };
            const mulchStacks = totalBalesBags.mulch / CONSTANTS.BALES_PER_MULCH_STACK;
            const areaAcres = area * CONSTANTS.HA_TO_ACRES;
            
            // --- 3. Update App UI ---
            const formatKg = (val) => `${val.toFixed(1)} kg`;
            const formatNum = (val, dec = 2) => val.toFixed(dec);
            outputs.mulchNeeded.textContent = formatKg(totalKg.mulch);
            outputs.mulchBales.textContent = formatNum(totalBalesBags.mulch, 2);
            outputs.seedNeeded.textContent = formatKg(totalKg.seed);
            outputs.seedBags.textContent = formatNum(totalBalesBags.seed, 2);
            outputs.fertilizerNeeded.textContent = formatKg(totalKg.fertilizer);
            outputs.fertilizerBags.textContent = formatNum(totalBalesBags.fertilizer, 2);
            outputs.aquaGelNeeded.textContent = formatKg(totalKg.aquaGel);
            outputs.aquaGelBags.textContent = formatNum(totalBalesBags.aquaGel, 2);
            outputs.totalLoads.textContent = formatNum(totalLoads);
            outputs.areaPerLoad.textContent = `${areaPerLoad.toFixed(0)} m²`;
            outputs.seedPerLoad.textContent = formatKg(perLoad.seed);
            outputs.fertilizerPerLoad.textContent = formatKg(perLoad.fertilizer);
            outputs.aquaGelPerLoad.textContent = formatKg(perLoad.aquaGel);
            outputs.mulchStacks.textContent = formatNum(mulchStacks);
            outputs.areaAcres.textContent = formatNum(areaAcres, 3);
            
            // --- 4. Update Print Invoice UI ---
            controls.printCustomer.textContent = inputs.customerName.value || 'N/A';
            controls.printDate.textContent = inputs.projectDate.value || 'N/A';
            controls.printArea.textContent = formatNum(area, 3);
            
            controls.printMulchRate.textContent = formatNum(mulchRate, 1);
            controls.printMulchNeeded.textContent = formatNum(totalKg.mulch, 1);
            controls.printMulchBales.textContent = formatNum(totalBalesBags.mulch, 2);
            
            controls.printSeedRate.textContent = formatNum(seedRate, 1);
            controls.printSeedNeeded.textContent = formatNum(totalKg.seed, 1);
            controls.printSeedBags.textContent = formatNum(totalBalesBags.seed, 2);
            
            controls.printFertRate.textContent = formatNum(fertilizerRate, 1);
            controls.printFertNeeded.textContent = formatNum(totalKg.fertilizer, 1);
            controls.printFertBags.textContent = formatNum(totalBalesBags.fertilizer, 2);
            
            controls.printAquaRate.textContent = formatNum(aquaGelRate, 1);
            controls.printAquaNeeded.textContent = formatNum(totalKg.aquaGel, 1);
            controls.printAquaBags.textContent = formatNum(totalBalesBags.aquaGel, 2);

            controls.printBalesLoad.textContent = formatNum(balesPerLoad, 0);
            controls.printTotalLoads.textContent = formatNum(totalLoads, 2);
            controls.printAreaLoad.textContent = `${formatNum(areaPerLoad, 0)} m²`;
            
            controls.printSeedLoad.textContent = formatKg(perLoad.seed);
            controls.printFertLoad.textContent = formatKg(perLoad.fertilizer);
            controls.printAquaLoad.textContent = formatKg(perLoad.aquaGel);
            
            controls.printMulchStacks.textContent = formatNum(mulchStacks, 2);
            controls.printAreaAcres.textContent = formatNum(areaAcres, 3);
            controls.printNotesContent.textContent = inputs.projectNotes.value || 'No notes.';
        }

        // --- RESET FUNCTION ---
        function resetForm() {
            inputs.customerName.value = '';
            inputs.projectDate.value = new Date().toISOString().split('T')[0]; // Reset date
            inputs.area.value = 0;
            inputs.mulchRate.value = 0;
            inputs.seedRate.value = 0;
            inputs.fertilizerRate.value = 0;
            inputs.aquaGelRate.value = 0;
            inputs.jumpStartRate.value = 0;
            inputs.bsmRate.value = 0;
            inputs.projectNotes.value = ''; // Reset notes
            inputs.balesPerLoad.value = 30;
            inputs.balesPerLoadSlider.value = 30;
            inputs.seedBagWeight.value = 25;
            inputs.fertilizerBagWeight.value = 25;
            inputs.aquaGelBagWeight.value = 25;
            checkNotes(); // Update star indicator
            calculate();
        }

        // --- NOTES INDICATOR ---
        function checkNotes() {
            if (inputs.projectNotes.value.trim().length > 0) {
                controls.notesIndicator.classList.remove('hidden');
            } else {
                controls.notesIndicator.classList.add('hidden');
            }
        }

        // --- APP INITIALIZATION ---
        function initializeAppLogic() {
            // 1. Map all App DOM elements
            inputs = {
                customerName: document.getElementById('customerName'),
                projectDate: document.getElementById('projectDate'), // Added date
                area: document.getElementById('area'),
                mulchRate: document.getElementById('mulchRate'),
                seedRate: document.getElementById('seedRate'),
                fertilizerRate: document.getElementById('fertilizerRate'),
                aquaGelRate: document.getElementById('aquaGelRate'),
                jumpStartRate: document.getElementById('jumpStartRate'),
                bsmRate: document.getElementById('bsmRate'),
                projectNotes: document.getElementById('projectNotes'), // Add notes
                balesPerLoad: document.getElementById('balesPerLoad'),
                balesPerLoadSlider: document.getElementById('balesPerLoadSlider'),
                seedBagWeight: document.getElementById('seedBagWeight'),
                fertilizerBagWeight: document.getElementById('fertilizerBagWeight'),
                aquaGelBagWeight: document.getElementById('aquaGelBagWeight') 
            };

            outputs = {
                mulchNeeded: document.getElementById('mulchNeeded'),
                mulchBales: document.getElementById('mulchBales'),
                seedNeeded: document.getElementById('seedNeeded'),
                seedBags: document.getElementById('seedBags'),
                fertilizerNeeded: document.getElementById('fertilizerNeeded'),
                fertilizerBags: document.getElementById('fertilizerBags'),
                aquaGelNeeded: document.getElementById('aquaGelNeeded'),
                aquaGelBags: document.getElementById('aquaGelBags'),
                totalLoads: document.getElementById('totalLoads'),
                areaPerLoad: document.getElementById('areaPerLoad'),
                seedPerLoad: document.getElementById('seedPerLoad'),
                fertilizerPerLoad: document.getElementById('fertilizerPerLoad'),
                aquaGelPerLoad: document.getElementById('aquaGelPerLoad'),
                mulchStacks: document.getElementById('mulchStacks'),
                areaAcres: document.getElementById('areaAcres'),
            };

            // 2. Attach basic calculation listeners
            Object.values(inputs).forEach(input => {
                // Notes field doesn't trigger recalculation
                if (input.id !== 'projectNotes') {
                    input.addEventListener('input', calculate);
                }
            });
            
            // Listener for notes star
            inputs.projectNotes.addEventListener('input', checkNotes);
            
            // Sync slider and number input
            inputs.balesPerLoadSlider.addEventListener('input', (e) => {
                inputs.balesPerLoad.value = e.target.value;
                calculate();
            });
            inputs.balesPerLoad.addEventListener('input', (e) => {
                inputs.balesPerLoadSlider.value = e.target.value;
                calculate();
            });

            // 3. Attach new control listeners
            controls.resetButton.addEventListener('click', resetForm);
            
            // 4. Set today's date
            inputs.projectDate.value = new Date().toISOString().split('T')[0];
            
            // 5. Run initial calculation & notes check
            calculate();
            checkNotes();
        }

        // --- MAIN ENTRY POINT ---
        document.addEventListener('DOMContentLoaded', () => {
            initializeAppLogic();
        });

    </script>
</body>
</html>

